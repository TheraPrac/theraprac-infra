# =============================================================================
# Ziti Controller Configuration
# =============================================================================
# Generated by Ansible - DO NOT EDIT MANUALLY
# Template: roles/ziti/templates/controller.yaml.j2
# =============================================================================

v: 3

# Database location
db: {{ ziti_home }}/data/ctrl.db

# Controller identity (PKI)
identity:
  cert: {{ ziti_pki_dir }}/root-ca/certs/server.cert
  server_cert: {{ ziti_pki_dir }}/root-ca/certs/server.cert
  key: {{ ziti_pki_dir }}/root-ca/keys/server.key
  ca: {{ ziti_pki_dir }}/root-ca/certs/root-ca.cert

# Internal control plane listener (router connections)
ctrl:
  listener: tls:{{ ziti_controller_internal_addr }}

# Edge API configuration
edge:
  enrollment:
    signingCert:
      cert: {{ ziti_pki_dir }}/root-ca/certs/root-ca.cert
      key: {{ ziti_pki_dir }}/root-ca/keys/root-ca.key
    edgeIdentity:
      duration: 180m
    edgeRouter:
      duration: 180m

# Web listeners (APIs)
web:
  - name: all-apis
    bindPoints:
      - interface: 0.0.0.0:{{ ziti_controller_port }}
        address: {{ ziti_domain }}:443
    identity:
      cert: {{ ziti_pki_dir }}/root-ca/certs/server.cert
      server_cert: {{ ziti_pki_dir }}/root-ca/certs/server.cert
      key: {{ ziti_pki_dir }}/root-ca/keys/server.key
      ca: {{ ziti_pki_dir }}/root-ca/certs/root-ca.cert
    options:
      idleTimeout: 5000ms
      readTimeout: 5000ms
      writeTimeout: 100000ms
      minTLSVersion: TLS1.2
      maxTLSVersion: TLS1.3
    apis:
      - binding: edge-management
      - binding: edge-client
      - binding: fabric

# TODO: Add healthChecks section if needed
# TODO: Add events section for audit logging
# TODO: Consider adding raft configuration for HA

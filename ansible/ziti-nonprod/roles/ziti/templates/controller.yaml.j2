# =============================================================================
# Ziti Controller Configuration
# =============================================================================
# Generated by Ansible for {{ environment }}
# =============================================================================

v: 3

db: {{ ziti_home }}/data/ctrl.db

identity:
  cert: {{ ziti_home }}/pki/server/server.cert
  server_cert: {{ ziti_home }}/pki/server/server.cert
  key: {{ ziti_home }}/pki/server/server.key
  ca: {{ ziti_home }}/pki/ca-bundle.cert

ctrl:
  listener: tls:127.0.0.1:6262
  options:
    advertiseAddress: tls:{{ ziti_domain }}:{{ ziti_controller_port }}

edge:
  api:
    address: 0.0.0.0:{{ ziti_controller_port }}
  enrollment:
    signingCert:
      cert: {{ ziti_home }}/pki/intermediate/intermediate-ca.cert
      key: {{ ziti_home }}/pki/intermediate/intermediate-ca.key
    edgeIdentity:
      duration: 180m
    edgeRouter:
      duration: 180m

web:
  - name: client-management
    bindPoints:
      - interface: 0.0.0.0:{{ ziti_controller_port }}
        address: {{ ziti_domain }}:{{ ziti_controller_port }}
    identity:
      cert: {{ ziti_home }}/pki/server/server.cert
      server_cert: {{ ziti_home }}/pki/server/server.cert
      key: {{ ziti_home }}/pki/server/server.key
      ca: {{ ziti_home }}/pki/ca-bundle.cert
    options:
      idleTimeout: 5000ms
      readTimeout: 5000ms
      writeTimeout: 100000ms
      minTLSVersion: TLS1.2
      maxTLSVersion: TLS1.3
    apis:
      - binding: edge-management
        options: {}
      - binding: edge-client
        options: {}
      - binding: fabric
        options: {}
      - binding: health-checks
        options: {}

healthChecks:
  boltCheck:
    interval: 30s
    timeout: 20s
    initialDelay: 30s

